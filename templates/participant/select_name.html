{% extends "base.html" %}

{% block title %}Select Your Name - The 55{% endblock %}

{% block header %}
<header class="participant-header">
    <div class="container">
        <h1>The 55</h1>
        <span class="team-badge">{{ team.team_name }}</span>
    </div>
</header>
{% endblock %}

{% block content %}
<div class="select-page">
    <div class="select-card">
        <h2>Who Are You?</h2>
        <p class="select-subtitle">Select your name from the list</p>

        <form method="post" action="/join/{{ team.code }}/session/{{ session.id }}/name">
            <div class="name-grid" id="name-grid">
                {% for member in members %}
                <button type="button"
                        class="name-card {% if member.id in responded_ids %}responded{% endif %}"
                        data-member-id="{{ member.id }}"
                        {% if member.id in responded_ids %}disabled aria-disabled="true"{% endif %}
                        aria-label="{{ member.name }}{% if member.id in responded_ids %} (already responded){% endif %}">
                    <span class="name-card-text">{{ member.name }}</span>
                    {% if member.id in responded_ids %}
                    <span class="name-card-badge">Done</span>
                    {% endif %}
                </button>
                {% endfor %}
            </div>
            <input type="hidden" name="member_id" id="selected-member" required>
        </form>

        <script>
        (function() {
            const cards = document.querySelectorAll('.name-card:not(.responded)');
            const hiddenInput = document.getElementById('selected-member');

            cards.forEach(card => {
                card.addEventListener('click', function() {
                    hiddenInput.value = this.dataset.memberId;
                    document.querySelector('form').submit();
                });
            });
        })();
        </script>
    </div>
</div>
{% endblock %}
