{% extends "base.html" %}

{% block title %}AlignHQ - The 55{% endblock %}

{% block nav %}
<nav class="admin-nav">
    <div class="nav-links">
        <a href="/admin" class="nav-link nav-link-active">AlignHQ</a>
        <a href="/admin/settings" class="nav-link">Settings</a>
    </div>
    <a href="/admin/logout" class="btn btn-ghost btn-small">Logout</a>
</nav>
{% endblock %}

{% block content %}
<div class="dashboard command-center">
    <header class="dashboard-header">
        <h1>The 55</h1>
        <p class="dashboard-tagline">55 minutes. Once a month. The truth about where the team actually is.</p>
    </header>

    <!-- Two-column layout: Sessions left, Teams right -->
    <div class="dashboard-grid">
        <!-- Active Sessions (Left Column) -->
        <section class="dashboard-section dashboard-section-primary">
            <div class="section-header">
                <h2>Active Sessions</h2>
                <span class="section-badge">{{ active_sessions | length }} this month</span>
            </div>

            {% if active_sessions %}
            <div class="session-list">
                {% for session in active_sessions %}
                <a href="/admin/sessions/{{ session.id }}" class="card card-link session-card session-card-active">
                    <div class="session-team">{{ session.team.company_name }}</div>
                    <div class="session-team-name">{{ session.team.team_name }}</div>
                    <div class="session-meta">
                        <span class="session-month">{{ session.month }}</span>
                        <span class="session-state state-{{ session.state.value }}">{{ session.state.value }}</span>
                    </div>
                </a>
                {% endfor %}
            </div>
            {% else %}
            <div class="empty-state">
                <p>No active sessions this month.</p>
                <p class="text-secondary">Start a session from Teams.</p>
            </div>
            {% endif %}
        </section>

        <!-- Teams (Right Column) -->
        <section class="dashboard-section" id="teams">
            <div class="section-header">
                <h2>Teams</h2>
                <a href="/admin/teams/create" class="btn btn-primary btn-small">+ New Team</a>
            </div>

            <div class="teams-toolbar">
                <input type="search" id="dashboard-search" placeholder="Search teams..." class="search-input" autofocus>
                <div class="sort-controls">
                    <label class="sort-label">Sort:</label>
                    <select id="team-sort" class="sort-select">
                        <option value="company">Company</option>
                        <option value="team">Team Name</option>
                        <option value="recent">Recently Used</option>
                    </select>
                </div>
                <span class="teams-count"><span id="visible-count">{{ teams | length }}</span> of {{ teams | length }}</span>
            </div>

            {% if teams %}
            <div class="team-list" id="team-list">
                {% for team in teams %}
                <div class="team-row" data-company="{{ team.company_name|lower }}" data-team="{{ team.team_name|lower }}" data-searchable="{{ team.company_name }} {{ team.team_name }}">
                    <a href="/admin/sessions/team/{{ team.id }}" class="team-info">
                        <div class="team-company">{{ team.company_name }}</div>
                        <div class="team-name">{{ team.team_name }}</div>
                        <div class="team-meta">
                            <span class="team-code">{{ team.code }}</span>
                            <span class="team-members">{{ team.members | length }} members</span>
                        </div>
                    </a>
                    <div class="team-actions">
                        <a href="/admin/sessions/team/{{ team.id }}/create?month={{ current_month }}" class="btn btn-primary btn-small">New Session</a>
                        <a href="/admin/teams/{{ team.id }}" class="btn btn-ghost btn-small">Edit</a>
                    </div>
                </div>
                {% endfor %}
            </div>
            <div id="search-empty-state" class="empty-state hidden">
                <p>No teams match your search.</p>
            </div>
            {% else %}
            <div class="empty-state">
                <p>No teams yet.</p>
                <a href="/admin/teams/create" class="btn btn-primary">Create Your First Team</a>
            </div>
            {% endif %}
        </section>
    </div>
</div>

<script src="/static/js/dashboard.js"></script>
{% endblock %}
