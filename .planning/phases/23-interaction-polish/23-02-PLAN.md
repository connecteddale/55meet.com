---
phase: 36-interaction-polish
plan: 02
type: execute
wave: 2
depends_on: ["36-01"]
files_modified:
  - sites/55meet.com/templates/participant/respond.html
  - sites/55meet.com/static/js/progressive-inputs.js
  - sites/55meet.com/static/css/main.css
autonomous: true

must_haves:
  truths:
    - "Bullet section starts with only 1 visible input field (required)"
    - "Typing in the current last visible input reveals the next one (up to 5 max)"
    - "Each newly revealed input animates in smoothly (fade + slide down)"
    - "Existing bullet data (edit mode / draft restore) shows all populated inputs immediately"
    - "Submit validation still requires at least 1 bullet point"
  artifacts:
    - path: "sites/55meet.com/static/js/progressive-inputs.js"
      provides: "Progressive reveal logic for bullet inputs"
      contains: "progressive"
    - path: "sites/55meet.com/templates/participant/respond.html"
      provides: "Updated markup with hidden-by-default inputs and script include"
      contains: "progressive-inputs.js"
    - path: "sites/55meet.com/static/css/main.css"
      provides: "Progressive input reveal animation styles"
      contains: "bullet-input-hidden"
  key_links:
    - from: "templates/participant/respond.html"
      to: "static/js/progressive-inputs.js"
      via: "script tag"
      pattern: "progressive-inputs\\.js"
    - from: "static/js/progressive-inputs.js"
      to: "DOM .bullet-input elements"
      via: "querySelectorAll and classList toggle"
      pattern: "bullet-input-hidden"
---

<objective>
Implement progressive bullet input disclosure - start with 1 field, reveal next on typing, up to 5 max.

Purpose: TOUCH-03 reduces visual overwhelm. Participants see one field at first, inputs grow naturally as they type. Existing data (edit/draft) shows all populated fields immediately.
Output: progressive-inputs.js with reveal logic, updated respond.html markup, CSS animation for reveal.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md (Phase 36 section - TOUCH-03 requirement)
@sites/55meet.com/templates/participant/respond.html (current bullet section lines 56-94, JS lines 107-471)
@sites/55meet.com/static/css/main.css (lines 1465-1489: current .bullet-input styles)
@sites/55meet.com/static/css/variables.css (animation tokens)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add progressive input CSS and create progressive-inputs.js</name>
  <files>sites/55meet.com/static/css/main.css, sites/55meet.com/static/js/progressive-inputs.js</files>
  <action>
**1. Add CSS to main.css** — append these rules AFTER the existing `.bullet-input::placeholder` rule (after line 1489):

```css
/* Progressive Input Reveal (TOUCH-03) */
.bullet-input-hidden {
    display: none;
}

.bullet-input-reveal {
    animation: bullet-reveal 0.25s var(--ease-out) forwards;
}

@keyframes bullet-reveal {
    from {
        opacity: 0;
        transform: translateY(-8px);
        max-height: 0;
    }
    to {
        opacity: 1;
        transform: translateY(0);
        max-height: 60px;
    }
}
```

**2. Create `static/js/progressive-inputs.js`:**

```javascript
/**
 * Progressive Bullet Inputs (TOUCH-03)
 * Start with 1 visible input. Reveal next when user types in current last visible.
 * Max 5 inputs. Existing data shows all populated inputs immediately.
 */
(function() {
    'use strict';

    const SELECTOR = '.bullet-input';
    const HIDDEN_CLASS = 'bullet-input-hidden';
    const REVEAL_CLASS = 'bullet-input-reveal';

    function initProgressiveInputs() {
        const inputs = document.querySelectorAll(SELECTOR);
        if (inputs.length === 0) return;

        // Determine which inputs have pre-existing values (edit mode / draft restore)
        let lastPopulatedIndex = -1;
        inputs.forEach(function(input, idx) {
            if (input.value.trim().length > 0) {
                lastPopulatedIndex = idx;
            }
        });

        // Show inputs up to lastPopulated + 1 (so next empty one is visible)
        // Minimum: always show first input
        const showUpTo = Math.max(0, lastPopulatedIndex + 1);

        inputs.forEach(function(input, idx) {
            if (idx <= showUpTo) {
                // Visible — no hidden class, no animation (already populated or first)
                input.classList.remove(HIDDEN_CLASS);
            } else {
                // Hidden — will reveal progressively
                input.classList.add(HIDDEN_CLASS);
            }
        });

        // Attach input listeners for progressive reveal
        inputs.forEach(function(input, idx) {
            input.addEventListener('input', function() {
                revealNext(inputs, idx);
            });
        });
    }

    function revealNext(inputs, currentIdx) {
        // Only reveal next if current input has content
        if (inputs[currentIdx].value.trim().length === 0) return;

        // Find the next hidden input
        var nextIdx = currentIdx + 1;
        if (nextIdx >= inputs.length) return;

        var nextInput = inputs[nextIdx];
        if (!nextInput.classList.contains(HIDDEN_CLASS)) return;

        // Reveal with animation
        nextInput.classList.remove(HIDDEN_CLASS);
        nextInput.classList.add(REVEAL_CLASS);

        // Remove animation class after it completes (so it doesn't replay)
        nextInput.addEventListener('animationend', function handler() {
            nextInput.classList.remove(REVEAL_CLASS);
            nextInput.removeEventListener('animationend', handler);
        });
    }

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initProgressiveInputs);
    } else {
        initProgressiveInputs();
    }
})();
```

Key design decisions:
- Uses CSS class toggle (not inline styles) for animation
- Existing values: shows all populated inputs + one more (no animation on initial load)
- Only reveals on `input` event when current field has content
- Cleans up animation class after animationend to prevent replays
- IIFE pattern matches existing JS style in this project
- Does NOT interfere with the existing respond.html inline JS (bullet listeners, updateBulletsJson, etc.)
  </action>
  <verify>
Check CSS added: `grep 'bullet-input-hidden' sites/55meet.com/static/css/main.css`
Check JS exists: `ls sites/55meet.com/static/js/progressive-inputs.js`
Check animation keyframe: `grep 'bullet-reveal' sites/55meet.com/static/css/main.css`
  </verify>
  <done>progressive-inputs.js exists with reveal logic. main.css has .bullet-input-hidden and .bullet-input-reveal animation. Script is self-contained IIFE.</done>
</task>

<task type="auto">
  <name>Task 2: Update respond.html to integrate progressive inputs</name>
  <files>sites/55meet.com/templates/participant/respond.html</files>
  <action>
Two changes to `templates/participant/respond.html`:

**1. Add script tag** — at the end of the `{% block content %}` block (just before the closing `{% endblock %}`, after the inline `</script>` tag on line 471), add:

```html
<script src="/static/js/progressive-inputs.js"></script>
```

This loads AFTER the inline script so the inline JS has already set up any existing values (from draft restore or edit mode) before progressive-inputs.js runs and checks for populated fields.

**2. Update bullet input markup** — replace the current `.bullet-inputs` div (lines 67-93) with:

```html
            <div class="bullet-inputs">
                <input type="text"
                       class="bullet-input"
                       id="bullet-1"
                       placeholder="Bullet point 1 (required)"
                       maxlength="500"
                       required>
                <input type="text"
                       class="bullet-input bullet-input-hidden"
                       id="bullet-2"
                       placeholder="Bullet point 2 (optional)"
                       maxlength="500">
                <input type="text"
                       class="bullet-input bullet-input-hidden"
                       id="bullet-3"
                       placeholder="Bullet point 3 (optional)"
                       maxlength="500">
                <input type="text"
                       class="bullet-input bullet-input-hidden"
                       id="bullet-4"
                       placeholder="Bullet point 4 (optional)"
                       maxlength="500">
                <input type="text"
                       class="bullet-input bullet-input-hidden"
                       id="bullet-5"
                       placeholder="Bullet point 5 (optional)"
                       maxlength="500">
            </div>
```

Key change: inputs 2-5 have `bullet-input-hidden` class added. The progressive-inputs.js will remove this class based on existing values OR as user types.

**Important:** The inline JS (lines 107-471) must NOT be modified. It already handles:
- `loadDraft()` which populates input values
- `init()` which pre-fills from existing response
- `updateBulletsJson()` which reads all inputs including hidden ones
- `updateSubmitButton()` which checks bullet-1 value

The progressive-inputs.js runs AFTER this inline JS completes, so it sees any pre-populated values and reveals inputs accordingly.

**3. Update the instruction text** — change line 61's paragraph from:
```html
            <p>Enter 1-5 bullet points explaining your choice.</p>
```
to:
```html
            <p>Enter at least one bullet point explaining your choice.</p>
```

This matches the progressive UX (user doesn't need to know the max is 5 upfront).
  </action>
  <verify>
Check hidden classes in markup: `grep 'bullet-input-hidden' sites/55meet.com/templates/participant/respond.html`
Check script include: `grep 'progressive-inputs.js' sites/55meet.com/templates/participant/respond.html`
Check instruction text updated: `grep 'at least one bullet' sites/55meet.com/templates/participant/respond.html`
Verify inline JS unchanged: `grep 'updateBulletsJson' sites/55meet.com/templates/participant/respond.html`
  </verify>
  <done>respond.html has bullet-input-hidden on inputs 2-5, includes progressive-inputs.js after inline script, instruction text says "at least one". Existing JS logic for drafts/validation unchanged.</done>
</task>

</tasks>

<verification>
- `grep 'bullet-input-hidden' sites/55meet.com/templates/participant/respond.html` shows 4 matches (inputs 2-5)
- `grep 'progressive-inputs.js' sites/55meet.com/templates/participant/respond.html` returns script tag
- `cat sites/55meet.com/static/js/progressive-inputs.js` contains reveal logic with HIDDEN_CLASS toggle
- `grep 'bullet-reveal' sites/55meet.com/static/css/main.css` shows keyframe animation
- Existing inline JS in respond.html is NOT modified (loadDraft, updateBulletsJson, selectImage all intact)
</verification>

<success_criteria>
- Page loads with only 1 bullet input visible
- Typing in bullet 1 reveals bullet 2 with fade+slide animation
- Typing in bullet 2 reveals bullet 3, etc., up to max 5
- If editing an existing response with 3 bullets, all 3 + next empty one show immediately (no animation)
- Draft restore shows all populated fields + next one
- Submit still requires at least 1 bullet (existing validation unchanged)
- Hidden inputs still work with updateBulletsJson (display:none inputs have empty value, filtered by .filter(b => b))
</success_criteria>

<output>
After completion, create `.planning/phases/36-interaction-polish/36-02-SUMMARY.md`
</output>
