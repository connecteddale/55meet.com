---
phase: 10-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - the55/app/__init__.py
  - the55/app/main.py
  - the55/app/config.py
  - the55/app/dependencies.py
  - the55/requirements.txt
  - the55/.env.example
  - the55/README.md
autonomous: true

must_haves:
  truths:
    - "FastAPI app starts without errors"
    - "Settings load from .env file"
    - "Static files served from /static"
  artifacts:
    - path: "the55/app/main.py"
      provides: "FastAPI application entry point"
      contains: "FastAPI"
    - path: "the55/app/config.py"
      provides: "Pydantic settings"
      contains: "BaseSettings"
    - path: "the55/requirements.txt"
      provides: "Python dependencies"
      contains: "fastapi"
  key_links:
    - from: "main.py"
      to: "config.py"
      via: "Settings import"
      pattern: "from app.config import"
---

<objective>
Create The 55 App project scaffold with FastAPI structure, configuration, and dependencies.

Purpose: Establish the foundation directory structure and configuration patterns that all other plans build upon.
Output: Working FastAPI app skeleton at /var/www/the55/ that starts and serves requests.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/research/STACK.md
@.planning/research/ARCHITECTURE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create project directory structure</name>
  <files>the55/app/__init__.py, the55/app/main.py, the55/app/routers/__init__.py, the55/app/services/__init__.py, the55/app/db/__init__.py, the55/app/schemas/__init__.py, the55/app/templates/.gitkeep, the55/app/static/css/.gitkeep, the55/app/static/js/.gitkeep, the55/app/static/images/55/.gitkeep, the55/db/.gitkeep, the55/logs/.gitkeep</files>
  <action>
    Create The 55 App at /var/www/the55/ with the following structure:

    ```
    /var/www/the55/
    ├── app/
    │   ├── __init__.py
    │   ├── main.py              # FastAPI app entry point
    │   ├── config.py            # Settings via pydantic-settings
    │   ├── dependencies.py      # Shared dependencies
    │   ├── routers/
    │   │   └── __init__.py
    │   ├── services/
    │   │   └── __init__.py
    │   ├── db/
    │   │   └── __init__.py
    │   ├── schemas/
    │   │   └── __init__.py
    │   ├── templates/
    │   │   └── .gitkeep
    │   └── static/
    │       ├── css/
    │       ├── js/
    │       └── images/55/
    ├── db/                       # SQLite database location
    ├── logs/                     # Application logs
    ├── requirements.txt
    ├── .env.example
    └── README.md
    ```

    In main.py, create minimal FastAPI app:
    - Import FastAPI
    - Create app instance with title="The 55"
    - Mount static files at /static
    - Set up Jinja2 templates directory
    - Add health check endpoint at /health returning {"status": "ok"}

    Use lifespan context manager (not deprecated @app.on_event decorators).
  </action>
  <verify>ls -la /var/www/the55/app/ shows expected structure</verify>
  <done>Directory structure exists with main.py containing FastAPI app</done>
</task>

<task type="auto">
  <name>Task 2: Create configuration and dependencies</name>
  <files>the55/app/config.py, the55/app/dependencies.py, the55/requirements.txt, the55/.env.example</files>
  <action>
    Create config.py with pydantic-settings:
    ```python
    from pydantic_settings import BaseSettings

    class Settings(BaseSettings):
        # App
        app_name: str = "The 55"
        debug: bool = False

        # Database
        database_url: str = "sqlite:///db/the55.db"

        # Auth
        secret_key: str  # Required - for session signing
        facilitator_password_hash: str  # Required - bcrypt/argon2 hash

        # Claude API
        anthropic_api_key: str = ""  # Optional for dev

        class Config:
            env_file = ".env"
    ```

    Create dependencies.py with placeholder for database session dependency (will be completed in Plan 02):
    ```python
    from typing import Annotated
    from fastapi import Depends
    from app.config import Settings

    def get_settings():
        return Settings()

    SettingsDep = Annotated[Settings, Depends(get_settings)]
    ```

    Create requirements.txt with exact versions from research:
    ```
    fastapi[standard]==0.128.0
    uvicorn==0.40.0
    gunicorn==23.0.0
    Jinja2==3.1.6
    pydantic-settings==2.12.0
    anthropic==0.76.0
    pwdlib[argon2]==0.3.0
    itsdangerous==2.2.0
    python-multipart==0.0.21
    slowapi==0.1.9
    ```

    Create .env.example documenting required variables:
    ```
    # Required
    SECRET_KEY=your-secret-key-here-generate-with-openssl-rand-hex-32
    FACILITATOR_PASSWORD_HASH=argon2-hash-of-password

    # Optional (required for synthesis)
    ANTHROPIC_API_KEY=sk-ant-...

    # Optional
    DEBUG=false
    DATABASE_URL=sqlite:///db/the55.db
    ```
  </action>
  <verify>python -c "from pydantic_settings import BaseSettings; print('OK')" runs without error</verify>
  <done>Config loads from environment, requirements.txt contains all dependencies</done>
</task>

<task type="auto">
  <name>Task 3: Install dependencies and verify app starts</name>
  <files>the55/requirements.txt</files>
  <action>
    Install dependencies:
    ```bash
    cd /var/www/the55
    pip install -r requirements.txt
    ```

    Create a minimal .env file for testing (will be replaced with real values later):
    ```bash
    # Generate a test secret key
    SECRET_KEY=$(python -c "import secrets; print(secrets.token_hex(32))")

    # Generate a test password hash (password: "test")
    HASH=$(python -c "from pwdlib import PasswordHash; print(PasswordHash.recommended().hash('test'))")
    ```

    Write .env with generated values.

    Test that app starts:
    ```bash
    cd /var/www/the55
    uvicorn app.main:app --host 0.0.0.0 --port 8055
    # Should start without errors
    # Test: curl http://localhost:8055/health
    ```

    Stop uvicorn after verification.
  </action>
  <verify>curl http://localhost:8055/health returns {"status":"ok"}</verify>
  <done>App starts successfully, health endpoint responds</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] /var/www/the55/ directory structure exists
- [ ] FastAPI app imports and runs without errors
- [ ] Settings load from .env file
- [ ] /health endpoint returns {"status": "ok"}
- [ ] Static files mounting configured
- [ ] Templates directory configured
</verification>

<success_criteria>
- All tasks completed
- App starts with `uvicorn app.main:app`
- Configuration pattern established
- Directory structure ready for subsequent plans
</success_criteria>

<output>
After completion, create `.planning/phases/10-foundation/10-01-SUMMARY.md`
</output>
