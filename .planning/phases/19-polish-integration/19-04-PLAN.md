---
phase: 28-polish-integration
plan: 04
type: execute
wave: 1
depends_on: []
files_modified:
  - the55/app/templates/admin/dashboard.html
  - the55/app/templates/admin/settings.html
  - the55/app/templates/admin/sessions/view.html
  - the55/app/templates/admin/sessions/edit.html
  - the55/app/templates/admin/teams/view.html
  - the55/app/static/css/main.css
  - the55/app/static/js/polling.js
autonomous: true

must_haves:
  truths:
    - "All admin pages have consistent navigation with Dashboard, Settings, and Logout links"
    - "Back buttons return users to the expected parent page"
    - "Users see a spinner when waiting for async operations to complete"
    - "Form buttons show loading state during submission"
  artifacts:
    - path: "the55/app/templates/admin/sessions/view.html"
      provides: "Consistent admin nav pattern"
      contains: "admin-nav"
    - path: "the55/app/static/css/main.css"
      provides: "Button loading state styles"
      contains: "btn-loading"
  key_links:
    - from: "the55/app/templates/admin/sessions/view.html"
      to: "/admin"
      via: "nav link"
      pattern: 'href="/admin".*Dashboard'
    - from: "the55/app/static/js/polling.js"
      to: ".spinner"
      via: "show/hide on fetch"
      pattern: "classList.*(add|remove).*spinner"
---

<objective>
Standardize navigation across admin pages and add consistent loading state feedback.

Purpose: Ensure users always know where they are, can navigate predictably, and receive visual feedback during async operations. These address cross-page navigation consistency and loading states feedback requirements.

Output: Consistent admin-nav on all admin pages, loading spinners on async operations, button loading states on form submissions.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/28-polish-integration/28-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Standardize Admin Navigation</name>
  <files>the55/app/templates/admin/sessions/view.html, the55/app/templates/admin/sessions/edit.html, the55/app/templates/admin/teams/view.html</files>
  <action>
  The research identified inconsistent navigation patterns. Standardize all admin pages to use the admin-nav pattern from dashboard.html and settings.html.

  **Standard admin-nav pattern (from research):**
  ```html
  {% block nav %}
  <nav class="admin-nav">
      <div class="nav-links">
          <a href="/admin" class="nav-link">Dashboard</a>
          <a href="/admin/settings" class="nav-link">Settings</a>
      </div>
      <a href="/admin/logout" class="btn btn-ghost btn-small">Logout</a>
  </nav>
  {% endblock %}
  ```

  1. Review sessions/view.html - if it uses "simple back nav" pattern, update to admin-nav pattern
  2. Review sessions/edit.html - if it uses "simple back nav" pattern, update to admin-nav pattern
  3. Review teams/view.html - if it uses "simple back nav" pattern, update to admin-nav pattern

  For detail pages that need a back button, add a breadcrumb-style link within the page content (not in nav):
  ```html
  <div class="page-header">
      <a href="/admin" class="breadcrumb-link">‚Üê Dashboard</a>
      <h1>Session: {{ session.team.team_name }}</h1>
  </div>
  ```

  Note: The key is that admin-nav is consistent, while contextual back links appear in page content.
  </action>
  <verify>
  - Visit /admin/sessions/{id} - admin-nav should show Dashboard, Settings, Logout
  - Visit /admin/teams/{id} - admin-nav should show Dashboard, Settings, Logout
  - Logout link visible from all admin pages
  </verify>
  <done>All admin pages use consistent admin-nav with Dashboard, Settings, and Logout</done>
</task>

<task type="auto">
  <name>Task 2: Add Loading States to Async Operations</name>
  <files>the55/app/static/css/main.css, the55/app/static/js/polling.js</files>
  <action>
  The research identified loading state gaps. Add consistent spinner feedback.

  1. Add button loading state CSS to main.css:
  ```css
  /* Button loading state */
  .btn-loading {
      position: relative;
      color: transparent !important;
      pointer-events: none;
  }

  .btn-loading::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 16px;
      height: 16px;
      margin: -8px 0 0 -8px;
      border: 2px solid currentColor;
      border-top-color: transparent;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
  }

  /* Ensure spinner animation is defined (may already exist) */
  @keyframes spin {
      to { transform: rotate(360deg); }
  }
  ```

  2. In polling.js, show loading spinner during fetch operations:
     - Find the pagination fetch handler (if exists)
     - Add spinner show/hide around fetch calls
     - Pattern: element.classList.add('loading') before fetch, remove after

  3. If image browser pagination exists in polling.js or separate file:
     - Add "Loading..." or spinner container that shows during page fetch
     - Hide spinner when new content loads

  Note: The existing spinner class uses `animation: spin 1.5s linear infinite` - keep this for large spinners, use 0.8s for button spinners (smaller, faster feedback).
  </action>
  <verify>
  - Click pagination in image browser - spinner or loading indicator appears
  - Check CSS has .btn-loading class defined
  </verify>
  <done>Loading spinners appear during async operations</done>
</task>

<task type="auto">
  <name>Task 3: Add Form Submit Loading States</name>
  <files>the55/app/templates/admin/settings.html, the55/app/templates/admin/sessions/edit.html</files>
  <action>
  Add loading state to form submit buttons for better feedback.

  1. For forms with submit buttons, add a small inline script or enhance existing JS:
  ```html
  <form method="post" onsubmit="this.querySelector('button[type=submit]').classList.add('btn-loading')">
      <!-- form fields -->
      <button type="submit" class="btn btn-primary">Save Changes</button>
  </form>
  ```

  2. Apply to:
     - settings.html password change form
     - sessions/edit.html session edit form (if exists)
     - Any other forms with submit buttons

  Alternative approach if JS is centralized:
  ```javascript
  // Add to a shared script
  document.querySelectorAll('form').forEach(form => {
      form.addEventListener('submit', () => {
          const btn = form.querySelector('button[type=submit]');
          if (btn) btn.classList.add('btn-loading');
      });
  });
  ```

  Choose the approach that fits the existing codebase pattern.
  </action>
  <verify>
  - Submit settings form - button shows loading spinner
  - Submit any admin form - button shows loading spinner during submission
  </verify>
  <done>Form buttons show loading state during submission</done>
</task>

</tasks>

<verification>
1. Navigation: All admin pages show Dashboard, Settings, Logout in nav
2. Navigation: Detail pages have contextual back links in content area
3. Loading: Pagination shows spinner during page load
4. Loading: Form submit buttons show loading state
5. Consistency: No mixed navigation patterns across admin section
</verification>

<success_criteria>
- All admin pages use admin-nav pattern
- Back/breadcrumb links are contextual, not in main nav
- Async operations show loading feedback
- Form submissions show button loading state
- Users always have clear path back to Dashboard
</success_criteria>

<output>
After completion, create `.planning/phases/28-polish-integration/28-04-SUMMARY.md`
</output>
