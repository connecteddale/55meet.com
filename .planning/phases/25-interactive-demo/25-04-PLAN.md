---
phase: 25-interactive-demo
plan: 04
type: execute
wave: 4
depends_on: ["25-03"]
files_modified:
  - app/routers/demo.py
  - templates/demo/synthesis.html
  - templates/landing.html
autonomous: true

must_haves:
  truths:
    - "Visitor sees pre-crafted synthesis revealing Alignment gap"
    - "Synthesis display matches real app synthesis UI"
    - "Demo concludes with clear call-to-action"
    - "Landing page 'See how it works' links to /demo"
  artifacts:
    - path: "app/routers/demo.py"
      provides: "Pre-baked synthesis data"
      contains: "DEMO_SYNTHESIS"
    - path: "templates/demo/synthesis.html"
      provides: "Demo synthesis reveal"
      contains: "gap-alignment"
    - path: "templates/landing.html"
      provides: "Demo CTA link"
      contains: "/demo"
  key_links:
    - from: "templates/landing.html"
      to: "/demo"
      via: "CTA button href"
      pattern: "href=./demo"
    - from: "templates/demo/synthesis.html"
      to: "participant/synthesis.html"
      via: "matching structure"
      pattern: "synthesis-section"
---

<objective>
Create the synthesis reveal page showing the pre-crafted analysis of the Alignment gap, then update the landing page to properly link to the demo.

Purpose: This is the climax of the demo - the visitor sees how The 55 synthesizes team responses to reveal the primary gap (Alignment - handoff/coordination issues). The CTA converts interest into action.

Output: Working /demo/synthesis page with reveal + CTA, landing page "See how it works" linking to /demo
</objective>

<execution_context>
@/home/DrPloy/.claude/get-shit-done/workflows/execute-plan.md
@/home/DrPloy/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/25-interactive-demo/25-RESEARCH.md
@.planning/phases/25-interactive-demo/25-01-SUMMARY.md
@.planning/phases/25-interactive-demo/25-02-SUMMARY.md
@.planning/phases/25-interactive-demo/25-03-SUMMARY.md

# Key reference for synthesis UI
@templates/participant/synthesis.html (MUST MATCH this structure)
@templates/landing.html (update CTA link)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add synthesis data and route to demo router</name>
  <files>
    app/routers/demo.py
  </files>
  <action>
Add to app/routers/demo.py:

1. Pre-baked synthesis constant DEMO_SYNTHESIS:
   ```python
   DEMO_SYNTHESIS = {
       "themes": "Your team is aligned on WHERE you're going, but the WORK isn't fitting together. The drag is in the handoffs - particularly between product development and client-facing teams. Each function is executing independently, creating gaps where value should compound.",
       "gap_type": "Alignment",
       "statements": [
           {
               "statement": "Product development and client-facing teams are operating on different timelines",
               "participants": ["Sarah", "Michael"]  # Will be replaced with actual first names
           },
           {
               "statement": "Features are being built without clear alignment to client priorities",
               "participants": ["Sarah", "James"]
           },
           {
               "statement": "Handoffs between departments are where momentum is lost",
               "participants": ["James", "Rachel"]
           }
       ]
   }
   ```

2. Route GET /demo/synthesis -> demo_synthesis():
   - Get seed from query param (required)
   - If no seed, redirect to /demo
   - Get shuffled team to extract first names
   - Create synthesis_data by copying DEMO_SYNTHESIS and replacing participant names:
     - Map role -> first_name from shuffled team
     - For each statement, replace placeholder names with actual shuffled names
   - Return templates.TemplateResponse("demo/synthesis.html", {
       request,
       company: DEMO_COMPANY,
       synthesis_themes: synthesis_data["themes"],
       synthesis_gap_type: synthesis_data["gap_type"],
       synthesis_statements: synthesis_data["statements"],
       seed
     })

Note: The synthesis references team member first names, which must match the shuffled names from earlier in the demo.
  </action>
  <verify>
curl -s "http://localhost:8000/demo/synthesis?seed=12345" | grep -q "Alignment" && echo "Gap type present" || echo "FAIL"
python -c "from app.routers.demo import DEMO_SYNTHESIS; print(f'Synthesis has {len(DEMO_SYNTHESIS[\"statements\"])} statements')"
  </verify>
  <done>
DEMO_SYNTHESIS constant defined with Alignment gap content, /demo/synthesis route serves synthesis with correct team member names based on seed
  </done>
</task>

<task type="auto">
  <name>Task 2: Create synthesis template matching real app UI</name>
  <files>
    templates/demo/synthesis.html
  </files>
  <action>
Create templates/demo/synthesis.html closely following participant/synthesis.html structure:

1. Extends base.html, title "Synthesis Reveal - Demo"

2. Header with branding and company badge

3. .synthesis-page container with .demo-synthesis modifier

4. Synthesis header:
   - "Demo" label badge
   - "{{ company.name }} Team Synthesis" heading

5. Gap section (MUST match participant/synthesis.html):
   ```html
   <div class="synthesis-section gap-section">
     <h3>Primary Gap</h3>
     <div class="gap-indicator gap-{{ synthesis_gap_type|lower }}">
       <span class="gap-type">{{ synthesis_gap_type }}</span>
     </div>
     <p class="gap-description">
       {% if synthesis_gap_type == 'Alignment' %}
       The team's work is disconnected or uncoordinated.
       {% endif %}
     </p>
   </div>
   ```

6. Themes section:
   ```html
   <div class="synthesis-section themes-section">
     <h3>Team Themes</h3>
     <p class="themes-text">{{ synthesis_themes }}</p>
   </div>
   ```

7. Statements section:
   ```html
   <div class="synthesis-section statements-section">
     <h3>Key Insights</h3>
     <ul class="insights-list">
       {% for stmt in synthesis_statements %}
       <li class="insight-item">
         <span class="insight-text">{{ stmt.statement }}</span>
         <span class="insight-attribution">({{ stmt.participants|join(', ') }})</span>
       </li>
       {% endfor %}
     </ul>
   </div>
   ```

8. Demo-specific CTA section (NOT in real synthesis):
   ```html
   <div class="demo-cta-section">
     <h3>Ready to find your team's drag?</h3>
     <p>The 55 is a 55-minute monthly diagnostic that makes real divergence visible - so you can fix what's actually slowing you down.</p>

     <div class="demo-cta-buttons">
       <a href="mailto:dale@connecteddale.com?subject=The%2055%20Inquiry" class="btn btn-primary btn-large">Book Your First Session</a>
       <a href="/" class="btn btn-secondary">Learn More</a>
     </div>

     <p class="demo-restart">
       <a href="/demo">Restart Demo</a>
     </p>
   </div>
   ```

9. JS to clear demo state on page load (fresh start for next demo):
   ```javascript
   sessionStorage.removeItem('the55-demo-response');
   ```

10. View Transition names for smooth entry

11. Reuse existing CSS classes from participant/synthesis.html. Add minimal demo-specific styles:
    - .demo-cta-section: margin-top, text-align center, padding
    - .demo-cta-buttons: flex gap for buttons
    - .demo-restart: small muted link
  </action>
  <verify>
curl -s "http://localhost:8000/demo/synthesis?seed=12345" | grep -q "gap-alignment" && echo "Gap indicator present" || echo "FAIL"
curl -s "http://localhost:8000/demo/synthesis?seed=12345" | grep -q "themes-section" && echo "Themes section present" || echo "FAIL"
curl -s "http://localhost:8000/demo/synthesis?seed=12345" | grep -q "Book Your First Session" && echo "CTA present" || echo "FAIL"
curl -s "http://localhost:8000/demo/synthesis?seed=12345" | grep -q "Restart Demo" && echo "Restart link present" || echo "FAIL"
  </verify>
  <done>
/demo/synthesis displays pre-crafted synthesis with Alignment gap, matching real app UI, with prominent CTA and restart option
  </done>
</task>

<task type="auto">
  <name>Task 3: Verify landing page demo CTA link</name>
  <files>
    templates/landing.html
  </files>
  <action>
Check templates/landing.html for the demo CTA link.

The landing page already has:
```html
<a href="/demo" class="btn btn-primary btn-large landing-cta">See how it works</a>
```

Verify this link:
1. Exists in the CTA section
2. Points to /demo (not /demo/ or other variation)
3. Has appropriate button classes

If the link is missing or incorrect, add/fix it in the CTA section:
```html
<!-- CTA -->
<section id="cta" class="landing-section">
    <div class="landing-content reveal">
        <h2 class="landing-section-headline">You've felt the drag.<br>Now find it.</h2>
        <a href="/demo" class="btn btn-primary btn-large landing-cta">See how it works</a>
    </div>
</section>
```

The existing landing.html appears to already have the correct link. Only modify if verification shows it's missing or broken.
  </action>
  <verify>
curl -s "http://localhost:8000/" | grep -q 'href="/demo"' && echo "Demo link present on landing" || echo "FAIL: Demo link missing"
curl -s "http://localhost:8000/" | grep -q "See how it works" && echo "CTA text correct" || echo "FAIL: CTA text wrong"
  </verify>
  <done>
Landing page has "See how it works" CTA linking to /demo
  </done>
</task>

</tasks>

<verification>
Complete end-to-end demo flow:
1. Visit landing page (/) - click "See how it works"
2. Land on /demo - see ClearBrief context and team
3. Click "Begin Signal Capture" - browse images, select one, enter bullets
4. Click "See Team Responses" - see your response + 4 team responses
5. Click "See What We Found" - see synthesis with Alignment gap
6. Primary CTA: "Book Your First Session" (mailto link)
7. Secondary: "Learn More" returns to landing
8. "Restart Demo" clears state and returns to /demo

Verify synthesis matches real app:
- Same section structure (gap, themes, statements)
- Same CSS classes
- Same attribution format
- Alignment gap indicator styled correctly

Verify CTAs work:
- Book session opens email
- Learn more goes to landing
- Restart clears sessionStorage and goes to /demo
</verification>

<success_criteria>
- /demo/synthesis shows pre-crafted Alignment gap synthesis
- Synthesis UI matches real participant/synthesis.html structure
- Team member names in synthesis match those from intro (same seed)
- Clear CTAs: Book session, Learn more, Restart demo
- Landing page links to /demo
- Demo state cleared on synthesis page (ready for next visitor)
</success_criteria>

<output>
After completion, create `.planning/phases/25-interactive-demo/25-04-SUMMARY.md`
</output>
